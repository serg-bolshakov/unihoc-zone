<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Всё для флорбола. Найти, выбрать и купить лучшую экипировку для флорбола для детей и взрослых от ведущего мирового производителя." />
    <meta name="keywords" content="Товары для флорбола, флорбольная экипировка для взрослых и детей. Флорбольные клюшки, мячи, борта, ворота. Для вратарей." />
    <meta name="robots" content="INDEX,FOLLOW" />
    <link type="image/png" sizes="16x16" rel="icon" href="/icon/favicon-16x16.png">
    <link type="image/png" sizes="32x32" rel="icon" href="/icons/favicon-32x32.png">
    <link type="image/png" sizes="96x96" rel="icon" href="/icons/favicon-96x96.png">
    <link type="image/png" sizes="120x120" rel="icon" href="/icons/favicon-120x120.png">
    <link type="image/png" sizes="256x256" rel="icon" href="/icons/favicon-256x256.png"
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/styles/style.css" />
    <link rel="stylesheet" href="/styles/main.css" />
    <link rel="stylesheet" href="/styles/products.css"> 
    <title>UnihocZoneRussia. Флорбол. Экипировка Unihoc и Zonefloorball</title>
</head>

<body>
    <container class="container-products">
    <?php require_once $_SERVER['DOCUMENT_ROOT'] .'/elems/header.php'; ?>    
        <section class="content-products">
            <div class="products-type">
                <img
                    src="/images/main/banner-our-story.jpg"
                    alt="products-title_banner"
                />
                <div class="products-item product-title">
                    <h1>Экипировка и оборудование для флорбола</h1>
                </div>
            </div>  
        </section>
        <section class="nav-bar">
            <?php include $_SERVER['DOCUMENT_ROOT'].'/elems/nav-bar.php'?>
        </section>

        <!--Делаем меню типа "Аккордеон"-->
        <aside class="menu-products">
            <div class="category-description">
                <p>Ведущий мировой производитель флорбольной экипировки представлен нами в России 
                с момента зарождения этой игры у нас в стране в 1993-м году. Сегодня Юнихок (UNIHOC) - официальный партнёр и спонсор международной федерации флорбола (IFF), 
                производит высококачественную и профессиональную экипировку для игроков всех возрастов и квалификации. 
                Бренд ZONE вошёл в историю в 2011-м году, произведя революцию в самом понимании и представлении игры в флорбол. 
                Это, пожалуй, лучшее, что есть на сегодня в мире.</p>
            </div>
            
            <button class="accordion">КЛЮШКИ</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p><a href="">EVOLAB</a></p>
                <p><a href="">EVOLAB</a></p>
                <p><a href="">CARBSKIN</a></p>
                <p><a href="">CARBSKIN CURVE</a></p>
                <p>EVOLAB</p>
                <p>CARBSKIN</p>
                <p>CARBSKIN CURVE</p>
                <p>SUPERSKIN</p>
                <p>SIGNATURE SERIES</p>
                <p>ECO</p>
                <p>SUPERSHAPE</p>
                <p>TITAN SERIES</p>
                <p>OVAL SERIES</p>
                <p>COMPOSITE</p>
                <p>COMPOSITE YOUNGSTER</p>
                <p>PLAYER</p>
                <p>ZORRO</p>
            </div>
                              
            <button class="accordion">КРЮКИ</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p><a href="">UNILITE</a></p>
                <p><a href="">ICONIC</a></p>
                <p><a href="">EPIC</a></p>  
                <p><a href="">SONIC</a></p>
                <p><a href="">UNITY</a></p>
                <p><a href="">CAVITY Z</a></p> 
                <p><a href="">EVO 3 HOOK</a></p>
                <p><a href="">HARDER</a></p>
                <p><a href="">HYPER</a></p>
                <p><a href="">MAKER</a></p>
                <p><a href="">MONSTR</a></p>
                <p><a href="">ZUPER</a></p>      
            </div>

            <button class="accordion">ОБМОТКИ</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p>ELITE</p>
                <p>PRO</p>
                <p>TOP</p>
            </div>
                    
            <button class="accordion">ОБУВЬ</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p>ВРАТАРСКАЯ</p>
                <p>ДЛЯ ПОЛЕВЫХ ИГРОКОВ</p>
            </div>

            <button class="accordion">ВРАТАРСКАЯ ЭКИПИРОВКА</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p>ШЛЕМЫ</p>
                <p>СВИТЕРЫ</p>
                <p>ШТАНЫ</p>
            </div>

            <button class="accordion">ОДЕЖДА</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p>ИГРОВАЯ ФОРМА</p>
                <p>ТРЕНИРОВОЧНАЯ</p>
                <p>ПОВСЕДНЕВНАЯ</p>
            </div>

            <button class="accordion">СУМКИ И ЧЕХЛЫ</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p>ЧЕХЛЫ ДЛЯ КЛЮШЕК</p>
                <p>ВРАТАРСКИЕ БАУЛЫ</p>
                <p>СПОРТИВНЫЕ СУМКИ</p>
            </div>

            <button class="accordion">АКСЕССУАРЫ</button>
            <div class="panel">
                <p><a href="">Смотреть все</a></p>
                <p><a href="">ОЧКИ ФЛОРБОЛЬНЫЕ</a></p>
                <p>НАПУЛЬСКИКИ И ПОВЯЗКИ</p>
                <p>БУТЫЛКИ ДЛЯ ВОДЫ</p>
                <p>РАЗНОЕ</p>
            </div>

            <button class="accordion">БАЗОВЫЙ АССОРТИМЕНТ</button>
            <div class="panel">
                <p>КЛЮШКИ</p>
                <p>МЯЧИ</p>
                <p>ОБОРУДОВАНИЕ</p>
            </div>
        </aside>
       
        <?php require_once $_SERVER['DOCUMENT_ROOT'].'/db.php';
        //номер страницы преобразовываем в команду, кот. будет доставать записи по 6 штук на страницу
        //$sql = "SELECT * FROM products LIMIT $fromNewPageStart, $notesOnPage"; 
        // стр 1 -> c 0, 6 записей, стр 2 -> с 6, 6 записей, стр 3 -> с 12, 6 записей...
        //выполняем запрос и результат кладём в переменную $result
        //$result=$connect->query($sql);
        
        $page = $_GET['page'] ?? 1;
        //проверяем, чтобы не ввели чего лишнего в адресную строну с номером страницы, чтобы скрипт не завис
        $page = filter_var($page, FILTER_VALIDATE_INT, array("options" =>
                    array('default' => 1, 'min_range' => 1, 'max_range' => 99  )));

        $notesOnPage = 6; //LIMIT количество товаров на странице начиная с 0 позиции, 6 товаров, далее с 6-й шесть товаров...
        $fromNewPageStart = ($page - 1) * $notesOnPage; 
        

        //делаем запрос, который посчитает количество записей в БД
        $sqlCount = "SELECT COUNT(DISTINCT p.id) as count FROM products p
                        LEFT JOIN prod_prop pp on p.id = pp.product_id
                        LEFT JOIN brands b on p.brand_id = b.id
                        LEFT JOIN images i on p.id = i.product_id
                        LEFT JOIN sizes s on s.id = p.size_id
                        LEFT JOIN prices p2 on p.id = p2.product_id
                    ";
        $resultCount = $connect->query($sqlCount);
        $count = $resultCount->fetch_assoc()['count']; //и в переменную $count запишем сразу число по ключу ['count'], а не массив
        //считаем количество страниц
        $pagesCount = ceil($count / $notesOnPage);


        $select = <<<SQL
            SELECT DISTINCT p.*, b.*, i.*, p2.*, s.*  FROM products p
                LEFT JOIN prod_prop pp on p.id = pp.product_id
                LEFT JOIN brands b on p.brand_id = b.id
                LEFT JOIN images i on p.id = i.product_id
                LEFT JOIN sizes s on s.id = p.size_id
                LEFT JOIN prices p2 on p.id = p2.product_id
                    WHERE img_showcase = true
                ORDER BY RAND()
                LIMIT $notesOnPage OFFSET $fromNewPageStart
SQL;
        $sql = $select;
        //выполняем запрос и результат кладём в переменную $products
        $products = $connect->query($sql);
        ?>    

        <section class="assortiment-cards">
            <?php include $_SERVER['DOCUMENT_ROOT'].'/elems/assortiment-cards.php'?>
        </section>
       
        <?php /*если количество страниц больше, чем 1 - запускаем пагинацию страниц*/if($pagesCount > 1): ?>
        <section class="pagination-products">
            <?php include $_SERVER['DOCUMENT_ROOT'].'/elems/pagination.php'?>
        </section>
        <?php endif; ?>
    <?php require_once $_SERVER['DOCUMENT_ROOT'] .'/elems/footer.php'; ?>
        